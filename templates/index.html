{% extends 'base.html' %}
{% block content %}
<script>window.__distinct_count__ = {{ distinct_count|int }};</script>
{% if years %}
<div class="year-filters">
  <span class="year-filters-label">Έτη:</span>
  <ul class="year-filters-list">
    {% for y in years %}
    <li>
      <form method="post" action="{% if y in disabled_years %}{{ url_for('main.enable_year', year_label=y) }}{% else %}{{ url_for('main.disable_year', year_label=y) }}{% endif %}">
        <button type="submit" class="year-toggle{% if y in disabled_years %} year-disabled{% endif %}">
          {{ y }}{% if y in disabled_years %} (Ανενεργό){% endif %}
        </button>
      </form>
    </li>
    {% endfor %}
  </ul>
</div>
{% endif %}
{% if requirements %}
<div class="year-filters">
  <span class="year-filters-label">Τύπος:</span>
  {% set req_map = {'required':'Υποχρεωτικό','elective':'Επιλογής'} %}
  <ul class="year-filters-list">
    {% for r in requirements %}
    <li>
      <form method="post" action="{% if r in disabled_requirements %}{{ url_for('main.enable_requirement', req_label=r) }}{% else %}{{ url_for('main.disable_requirement', req_label=r) }}{% endif %}">
        <button type="submit" class="filter-toggle req-toggle{% if r in disabled_requirements %} year-disabled{% endif %}">
          {{ req_map.get(r, r) }}{% if r in disabled_requirements %} (Ανενεργό){% endif %}
        </button>
      </form>
    </li>
    {% endfor %}
  </ul>
</div>
{% endif %}
<div class="schedule-grid">
  {% set day_map = {'Monday':'Δευτέρα','Tuesday':'Τρίτη','Wednesday':'Τετάρτη','Thursday':'Πέμπτη','Friday':'Παρασκευή','Saturday':'Σάββατο','Sunday':'Κυριακή'} %}
  {% for day, courses in grouped.items() %}
  <section class="day-column">
    <h2>{{ day_map.get(day, day) }}</h2>
    {% if courses %}
      <ul class="course-list">
      {% for c in courses %}
        <li class="course-item{% if not c.active %} inactive{% endif %}" data-course-id="{{ c.id }}">
          <a class="course-link" href="{{ c.url or '#' }}" target="_blank" rel="noopener noreferrer">
            <div class="course-time">{{ c.start.strftime('%H:%M') }} - {{ c.end.strftime('%H:%M') }}</div>
            <div class="course-title">{{ c.title }}</div>
            <div class="course-meta">
              {% if c.requirement %}
                <span class="badge {% if c.requirement == 'required' %}badge-required{% else %}badge-elective{% endif %}">
                  {{ 'Υποχρεωτικό' if c.requirement == 'required' else 'Επιλογής' }}
                </span>
              {% endif %}
              {% if not c.active %}
                <span class="badge badge-inactive">Ανενεργό</span>
              {% endif %}
              {{ c.kind }} | {{ c.room }}<br><small>{{ ', '.join(c.instructors) }}</small>
            </div>
          </a>
          <button type="button" class="remove-btn" data-remove="{{ url_for('main.remove_course', course_id=c.id) }}">{% if c.active %}✕{% else %}✓{% endif %}</button>
        </li>
      {% endfor %}
      </ul>
    {% else %}
  <p class="empty">Δεν υπάρχουν μαθήματα</p>
    {% endif %}
  </section>
  {% endfor %}
</div>
{% endblock %}
{% block scripts %}{% endblock %}